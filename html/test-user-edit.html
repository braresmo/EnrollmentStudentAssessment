<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test User Edit</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 p-8">
    <div class="max-w-md mx-auto bg-white p-6 rounded-lg shadow-md">
        <h2 id="form-title" class="text-xl font-bold mb-4">Add New User</h2>
        
        <form id="test-form">
            <input type="hidden" id="user-id">
            
            <div class="mb-4">
                <label for="user-password" class="block text-sm font-medium text-gray-700">Password</label>
                <input type="password" id="user-password" placeholder="Password" minlength="6" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md">
                <p id="password-help" class="text-xs text-gray-500 mt-1">Minimum 6 characters</p>
            </div>
            
            <div class="flex space-x-3">
                <button type="submit" id="submit-btn" class="bg-blue-600 text-white px-4 py-2 rounded">Add User</button>
                <button type="button" id="edit-btn" class="bg-green-600 text-white px-4 py-2 rounded">Simulate Edit</button>
                <button type="button" id="reset-btn" class="bg-gray-600 text-white px-4 py-2 rounded">Reset</button>
            </div>
        </form>
        
        <div class="mt-4 p-3 bg-gray-100 rounded">
            <p><strong>Current State:</strong></p>
            <p id="status">Initial state</p>
        </div>
    </div>

    <script>
        const API_BASE = 'http://localhost:8080';
        
        // Show current form state
        function showStatus() {
            const passwordField = document.getElementById('user-password');
            const userId = document.getElementById('user-id').value;
            const title = document.getElementById('form-title').textContent;
            const buttonText = document.getElementById('submit-btn').textContent;
            
            document.getElementById('status').innerHTML = `
                Mode: ${userId ? 'Edit' : 'Add'}<br>
                Title: ${title}<br>
                Button: ${buttonText}<br>
                Password Required: ${passwordField.required}<br>
                Password Placeholder: ${passwordField.placeholder}<br>
                MinLength: ${passwordField.getAttribute('minlength') || 'none'}
            `;
        }
        
        // Set form for new user
        function setFormForNewUser() {
            console.log('Setting form for new user...');
            const passwordField = document.getElementById('user-password');
            const passwordLabel = document.querySelector('label[for="user-password"]');
            const passwordHelp = document.getElementById('password-help');
            
            document.getElementById('user-id').value = '';
            document.getElementById('form-title').textContent = 'Add New User';
            document.getElementById('submit-btn').textContent = 'Add User';
            
            passwordField.required = true;
            passwordField.setAttribute('minlength', '6');
            passwordField.placeholder = 'Password';
            passwordLabel.textContent = 'Password';
            passwordHelp.textContent = 'Minimum 6 characters';
            passwordHelp.className = 'text-xs text-gray-500 mt-1';
            
            showStatus();
        }
        
        // Simulate edit mode
        function setFormForEdit() {
            console.log('Setting form for edit...');
            const passwordField = document.getElementById('user-password');
            const passwordLabel = document.querySelector('label[for="user-password"]');
            const passwordHelp = document.getElementById('password-help');
            
            document.getElementById('user-id').value = '123';
            document.getElementById('form-title').textContent = 'Edit User';
            document.getElementById('submit-btn').textContent = 'Update User';
            
            passwordField.required = false;
            passwordField.removeAttribute('minlength');
            passwordField.placeholder = 'Leave blank to keep current password';
            passwordLabel.textContent = 'Password (Optional)';
            passwordHelp.textContent = 'Leave blank to keep current password';
            passwordHelp.className = 'text-xs text-blue-600 mt-1';
            
            showStatus();
        }
        
        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            setFormForNewUser();
            
            document.getElementById('edit-btn').addEventListener('click', setFormForEdit);
            document.getElementById('reset-btn').addEventListener('click', setFormForNewUser);
            
            document.getElementById('test-form').addEventListener('submit', (e) => {
                e.preventDefault();
                const passwordValue = document.getElementById('user-password').value;
                const userId = document.getElementById('user-id').value;
                
                if (!userId && (!passwordValue || passwordValue.length < 6)) {
                    alert('Password is required for new users and must be at least 6 characters');
                    return;
                }
                
                alert('Form validation passed!');
            });
        });
    </script>
</body>
</html>